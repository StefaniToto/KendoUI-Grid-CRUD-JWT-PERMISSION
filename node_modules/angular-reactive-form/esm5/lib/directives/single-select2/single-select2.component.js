/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, forwardRef, ElementRef, Renderer } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import * as _ from 'lodash';
var SingleSelect2Component = /** @class */ (function () {
    function SingleSelect2Component(element, renderer) {
        this.element = element;
        this.renderer = renderer;
        this.defaultValue = null;
        this.onChange = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) { });
        this.onTouched = (/**
         * @return {?}
         */
        function () { });
        this.disabled = false;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    SingleSelect2Component.prototype.writeValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val) {
            this.value = val;
        }
    };
    Object.defineProperty(SingleSelect2Component.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._value = val;
            this.onChange(this._value);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} fn
     * @return {?}
     */
    SingleSelect2Component.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    SingleSelect2Component.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouched = fn;
    };
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    SingleSelect2Component.prototype.setDisabledState = /**
     * @param {?} isDisabled
     * @return {?}
     */
    function (isDisabled) {
        this.disabled = isDisabled;
    };
    /**
     * @return {?}
     */
    SingleSelect2Component.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.defaultValue = this.value;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.actionRender();
        }), 1);
    };
    /**
     * @return {?}
     */
    SingleSelect2Component.prototype.ngOnChanges = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.isClear === true) {
            this.defaultValue = undefined;
            setTimeout((/**
             * @return {?}
             */
            function () {
                $('#single-select2-reactive-form-' + _this.id)
                    .select2()
                    .select2('val', 'ok');
            }), 1);
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SingleSelect2Component.prototype.formatValues = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        return data;
    };
    /**
     * @return {?}
     */
    SingleSelect2Component.prototype.actionRender = /**
     * @return {?}
     */
    function () {
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var $this = this;
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var options = {
            formatResult: this.formatValues,
            formatSelection: this.formatValues
        };
        if (this.placeholder !== undefined && this.placeholder != null) {
            options.placeholder = this.placeholder;
        }
        if (this.isDisabled !== undefined && this.isDisabled != null && this.isDisabled === true) {
            options.disabled = true;
        }
        $('#single-select2-reactive-form-' + this.id).select2(options);
        if (_.isUndefined(this.defaultValue)) {
            /** @type {?} */
            var a_1 = $('#single-select2-reactive-form-' + this.id)
                .select2()
                .select2('val');
            this.value = _.find($this.options, (/**
             * @param {?} o
             * @return {?}
             */
            function (o) {
                return o.value === +a_1;
            }));
        }
        if (!_.isUndefined(this.defaultValue)) {
            $('#single-select2-reactive-form-' + this.id)
                .select2()
                .val(this.value.value)
                .trigger('change');
        }
        $('#single-select2-reactive-form-' + this.id).change((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var value = $(this).val();
            $this.value = _.find($this.options, (/**
             * @param {?} o
             * @return {?}
             */
            function (o) {
                return o.value === value;
            }));
        }));
    };
    SingleSelect2Component.decorators = [
        { type: Component, args: [{
                    // tslint:disable-next-line:component-selector
                    selector: 'single-select2',
                    template: "<select id=\"single-select2-reactive-form-{{ id }}\" class=\"form-control\" select2>\n  <option *ngFor=\"let opt of options\" value=\"{{ opt.value }}\" selected=\"{{ opt.selected }}\">{{ opt.label }}</option>\n</select>\n",
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return SingleSelect2Component; })),
                            multi: true
                        }
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SingleSelect2Component.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer }
    ]; };
    SingleSelect2Component.propDecorators = {
        placeholder: [{ type: Input }],
        options: [{ type: Input }],
        id: [{ type: Input }],
        _value: [{ type: Input }],
        isClear: [{ type: Input }],
        isDisabled: [{ type: Input }]
    };
    return SingleSelect2Component;
}());
export { SingleSelect2Component };
if (false) {
    /** @type {?} */
    SingleSelect2Component.prototype.placeholder;
    /** @type {?} */
    SingleSelect2Component.prototype.options;
    /** @type {?} */
    SingleSelect2Component.prototype.id;
    /** @type {?} */
    SingleSelect2Component.prototype._value;
    /** @type {?} */
    SingleSelect2Component.prototype.isClear;
    /** @type {?} */
    SingleSelect2Component.prototype.isDisabled;
    /** @type {?} */
    SingleSelect2Component.prototype.defaultValue;
    /**
     * @type {?}
     * @private
     */
    SingleSelect2Component.prototype.disabled;
    /**
     * @type {?}
     * @private
     */
    SingleSelect2Component.prototype.onChange;
    /**
     * @type {?}
     * @private
     */
    SingleSelect2Component.prototype.onTouched;
    /**
     * @type {?}
     * @private
     */
    SingleSelect2Component.prototype.element;
    /**
     * @type {?}
     * @private
     */
    SingleSelect2Component.prototype.renderer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2luZ2xlLXNlbGVjdDIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vYW5ndWxhci1yZWFjdGl2ZS1mb3JtLyIsInNvdXJjZXMiOlsibGliL2RpcmVjdGl2ZXMvc2luZ2xlLXNlbGVjdDIvc2luZ2xlLXNlbGVjdDIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBNEIsTUFBTSxlQUFlLENBQUM7QUFDN0csT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3pFLE9BQU8sS0FBSyxDQUFDLE1BQU0sUUFBUSxDQUFDO0FBRzVCO0lBZ0NFLGdDQUFvQixPQUFtQixFQUFVLFFBQWtCO1FBQS9DLFlBQU8sR0FBUCxPQUFPLENBQVk7UUFBVSxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBTm5FLGlCQUFZLEdBQUcsSUFBSSxDQUFDO1FBT2xCLElBQUksQ0FBQyxRQUFROzs7O1FBQUcsVUFBQyxHQUFRLElBQU0sQ0FBQyxDQUFBLENBQUM7UUFDakMsSUFBSSxDQUFDLFNBQVM7OztRQUFHLGNBQU8sQ0FBQyxDQUFBLENBQUM7UUFDMUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7SUFDeEIsQ0FBQzs7Ozs7SUFDRCwyQ0FBVTs7OztJQUFWLFVBQVcsR0FBUTtRQUNqQixJQUFJLEdBQUcsRUFBRTtZQUNQLElBQUksQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDO1NBQ2xCO0lBQ0gsQ0FBQztJQUVELHNCQUFJLHlDQUFLOzs7O1FBQVQ7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDckIsQ0FBQzs7Ozs7UUFFRCxVQUFVLEdBQUc7WUFDWCxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztZQUNsQixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztR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RUFBRSxDQUFDLENBQUMsTUFBTTs7O1FBQUM7O2dCQUM3QyxLQUFLLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRTtZQUMzQixLQUFLLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU87Ozs7WUFBRSxVQUFTLENBQUM7Z0JBQzVDLE9BQU8sQ0FBQyxDQUFDLEtBQUssS0FBSyxLQUFLLENBQUM7WUFDM0IsQ0FBQyxFQUFDLENBQUM7UUFDTCxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7O2dCQXpIRixTQUFTLFNBQUM7O29CQUVULFFBQVEsRUFBRSxnQkFBZ0I7b0JBQzFCLHlPQUE4QztvQkFFOUMsU0FBUyxFQUFFO3dCQUNUOzRCQUNFLE9BQU8sRUFBRSxpQkFBaUI7NEJBQzFCLFdBQVcsRUFBRSxVQUFVOzs7NEJBQUMsY0FBTSxPQUFBLHNCQUFzQixFQUF0QixDQUFzQixFQUFDOzRCQUNyRCxLQUFLLEVBQUUsSUFBSTt5QkFDWjtxQkFDRjs7aUJBQ0Y7Ozs7Z0JBakJzQyxVQUFVO2dCQUFFLFFBQVE7Ozs4QkFtQnhELEtBQUs7MEJBRUwsS0FBSztxQkFFTCxLQUFLO3lCQUVMLEtBQUs7MEJBRUwsS0FBSzs2QkFFTCxLQUFLOztJQWtHUiw2QkFBQztDQUFBLEFBMUhELElBMEhDO1NBN0dZLHNCQUFzQjs7O0lBQ2pDLDZDQUNvQjs7SUFDcEIseUNBQ2E7O0lBQ2Isb0NBQ1c7O0lBQ1gsd0NBQ1k7O0lBQ1oseUNBQ2lCOztJQUNqQiw0Q0FBNkI7O0lBRTdCLDhDQUFvQjs7Ozs7SUFFcEIsMENBQTBCOzs7OztJQUMxQiwwQ0FBMkI7Ozs7O0lBQzNCLDJDQUE0Qjs7Ozs7SUFFaEIseUNBQTJCOzs7OztJQUFFLDBDQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIGZvcndhcmRSZWYsIEVsZW1lbnRSZWYsIFJlbmRlcmVyLCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcbmRlY2xhcmUgY29uc3QgJDogYW55O1xuXG5AQ29tcG9uZW50KHtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxuICBzZWxlY3RvcjogJ3NpbmdsZS1zZWxlY3QyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3NpbmdsZS1zZWxlY3QyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vc2luZ2xlLXNlbGVjdDIuY29tcG9uZW50LmNzcyddLFxuICBwcm92aWRlcnM6IFtcbiAgICB7XG4gICAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFNpbmdsZVNlbGVjdDJDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWVcbiAgICB9XG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgU2luZ2xlU2VsZWN0MkNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBPbkNoYW5nZXMge1xuICBASW5wdXQoKVxuICBwbGFjZWhvbGRlcjogc3RyaW5nO1xuICBASW5wdXQoKVxuICBvcHRpb25zOiBhbnk7XG4gIEBJbnB1dCgpXG4gIGlkOiBudW1iZXI7XG4gIEBJbnB1dCgpXG4gIF92YWx1ZTogYW55O1xuICBASW5wdXQoKVxuICBpc0NsZWFyOiBCb29sZWFuO1xuICBASW5wdXQoKSBpc0Rpc2FibGVkOiBCb29sZWFuO1xuXG4gIGRlZmF1bHRWYWx1ZSA9IG51bGw7XG5cbiAgcHJpdmF0ZSBkaXNhYmxlZDogYm9vbGVhbjtcbiAgcHJpdmF0ZSBvbkNoYW5nZTogRnVuY3Rpb247XG4gIHByaXZhdGUgb25Ub3VjaGVkOiBGdW5jdGlvbjtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyKSB7XG4gICAgdGhpcy5vbkNoYW5nZSA9ICh2YWw6IGFueSkgPT4ge307XG4gICAgdGhpcy5vblRvdWNoZWQgPSAoKSA9PiB7fTtcbiAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cbiAgd3JpdGVWYWx1ZSh2YWw6IGFueSk6IHZvaWQge1xuICAgIGlmICh2YWwpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWw7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgfVxuXG4gIHNldCB2YWx1ZSh2YWwpIHtcbiAgICB0aGlzLl92YWx1ZSA9IHZhbDtcbiAgICB0aGlzLm9uQ2hhbmdlKHRoaXMuX3ZhbHVlKTtcbiAgfVxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuYWN0aW9uUmVuZGVyKCk7XG4gICAgfSwgMSk7XG4gIH1cblxuICBuZ09uQ2hhbmdlcygpIHtcbiAgICBpZiAodGhpcy5pc0NsZWFyID09PSB0cnVlKSB7XG4gICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAkKCcjc2luZ2xlLXNlbGVjdDItcmVhY3RpdmUtZm9ybS0nICsgdGhpcy5pZClcbiAgICAgICAgICAuc2VsZWN0MigpXG4gICAgICAgICAgLnNlbGVjdDIoJ3ZhbCcsICdvaycpO1xuICAgICAgfSwgMSk7XG4gICAgfVxuICB9XG4gIGZvcm1hdFZhbHVlcyhkYXRhKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBhY3Rpb25SZW5kZXIoKSB7XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1jb25zdFxuICAgIGxldCAkdGhpcyA9IHRoaXM7XG5cbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWNvbnN0XG4gICAgbGV0IG9wdGlvbnM6IGFueSA9IHtcbiAgICAgIGZvcm1hdFJlc3VsdDogdGhpcy5mb3JtYXRWYWx1ZXMsXG4gICAgICBmb3JtYXRTZWxlY3Rpb246IHRoaXMuZm9ybWF0VmFsdWVzXG4gICAgfTtcblxuICAgIGlmICh0aGlzLnBsYWNlaG9sZGVyICE9PSB1bmRlZmluZWQgJiYgdGhpcy5wbGFjZWhvbGRlciAhPSBudWxsKSB7XG4gICAgICBvcHRpb25zLnBsYWNlaG9sZGVyID0gdGhpcy5wbGFjZWhvbGRlcjtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNEaXNhYmxlZCAhPT0gdW5kZWZpbmVkICYmIHRoaXMuaXNEaXNhYmxlZCAhPSBudWxsICYmIHRoaXMuaXNEaXNhYmxlZCA9PT0gdHJ1ZSkge1xuICAgICAgb3B0aW9ucy5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuICAgICQoJyNzaW5nbGUtc2VsZWN0Mi1yZWFjdGl2ZS1mb3JtLScgKyB0aGlzLmlkKS5zZWxlY3QyKG9wdGlvbnMpO1xuICAgIGlmIChfLmlzVW5kZWZpbmVkKHRoaXMuZGVmYXVsdFZhbHVlKSkge1xuICAgICAgY29uc3QgYSA9ICQoJyNzaW5nbGUtc2VsZWN0Mi1yZWFjdGl2ZS1mb3JtLScgKyB0aGlzLmlkKVxuICAgICAgICAuc2VsZWN0MigpXG4gICAgICAgIC5zZWxlY3QyKCd2YWwnKTtcbiAgICAgIHRoaXMudmFsdWUgPSBfLmZpbmQoJHRoaXMub3B0aW9ucywgZnVuY3Rpb24obykge1xuICAgICAgICByZXR1cm4gby52YWx1ZSA9PT0gK2E7XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKHRoaXMuZGVmYXVsdFZhbHVlKSkge1xuICAgICAgJCgnI3NpbmdsZS1zZWxlY3QyLXJlYWN0aXZlLWZvcm0tJyArIHRoaXMuaWQpXG4gICAgICAgIC5zZWxlY3QyKClcbiAgICAgICAgLnZhbCh0aGlzLnZhbHVlLnZhbHVlKVxuICAgICAgICAudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgfVxuICAgICQoJyNzaW5nbGUtc2VsZWN0Mi1yZWFjdGl2ZS1mb3JtLScgKyB0aGlzLmlkKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9ICQodGhpcykudmFsKCk7XG4gICAgICAkdGhpcy52YWx1ZSA9IF8uZmluZCgkdGhpcy5vcHRpb25zLCBmdW5jdGlvbihvKSB7XG4gICAgICAgIHJldHVybiBvLnZhbHVlID09PSB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG4iXX0=